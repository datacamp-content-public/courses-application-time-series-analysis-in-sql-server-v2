---
title: Insert title here
key: 01dfaaa04b102f8161a3888ed2cc070d

---
## Computing simple arithmetic moving averages

```yaml
type: "TitleSlide"
key: "332887d866"
```

`@lower_third`

name: James Wang
title: Data Scientist


`@script`
We will be computing moving averages for numerical data encountered in all time series data sets. Moving averages are fundamental to analysing past trends and patterns in time series data. By the end of the lesson you will be able to split time series data by date, month, year, and compute moving averages for any given time period time lag to get a better understanding of the data.


---
## Setting up the date parameters of the data set

```yaml
type: "FullCodeSlide"
key: "a775f65724"
```

`@part1`
```
select 
year(date) as Y, month(date) as M, day(date) as D, *  
from dbo.data

```


`@script`
We numerical data for an entire year but the date is in the format yymmdd. We want to add year month day fields to the data as a first step so we can utilise the additional information to pinpoint the time series data we would like to work with at ease. We use the date, month and date functions to create additional columns to the time series data set. When this is run you can see that the extra columns will appear, which will allow us to create moving averages of the numerical information down the track by grouping by year, month or day.


---
## Creating row numbers

```yaml
type: "FullCodeSlide"
key: "2faa157ac2"
```

`@part1`
```
select a.*, row_number() over (partition by y order by y) as RowNumber
	from
	(
		select 
		year(date) as Y, 
                month(date) as M, 
                day(date) as D, *  
		from dbo.data
	) A
```


`@script`
To calculate moving averages we need a way to reference data going back in time. For example, for a 10 day moving average we need to get the data for the past 10 days inclusive of the current day. How do we do this? We need to create row numbers in ascending order and then reference back the number of time lags to obtain the moving average. In this step we use the row_number() function to create a row column as a reference point for time. How far back in time we need to go can be determined from this reference point for calculation of moving averages. 
Our data is for an entire year, or 365 days. We partition by year and order it by year to create a row column in ascending order for the entire year. This then can be used in the next step, to calculate moving averages based on a predefined time lag.


---
## Final Slide

```yaml
type: "FinalSlide"
key: "9f4dc1d849"
```

`@script`


